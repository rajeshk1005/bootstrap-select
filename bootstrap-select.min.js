$.fn.selectpick=function(e){var s={placeHolder:"",search:!1,searchPlaceHolder:"",title:"",listTitle:"",multiple:"multiple",pills:!1,disabled:"",checkbox:!1,closeButton:!1,buttonText:"Ok",searchResultText:"No results found",scrollMaxHeight:200},t=function(e){return window.spa?e.beginsWithStr("i18n:")?' data-i18n="'+e.trimLeftStr("i18n:")+'"':"":e},l=function(e){return window.spa&&e.beginsWithStr("i18n:")?"data-i18n=\"placeholder:'"+e+"'\"":' placeholder="'+e+'" '},o=$.extend({},s,e);return this.each(function(){var e=$(this),s=e.attr("id"),i=e.find("option"),n="",a=e.attr("multiple")||"",d=e.attr("disabled")||"",c=e.attr("class")||"",r=o.closeButton?"has-close-button":"no-close-button",p=d?'tabindex="-1"':"";i.each(function(e,s){var t=$(s),l=t.text(),o=t.is(":selected")?"selected":"",i=t.is(":disabled")?"disabled":"",a=i?'tabindex="-1"':"";t.attr("data-sl-rel",e),n+='<a class="dropdown-item '+o+" "+i+'" '+a+' href="javascript:;" data-dr-rel="'+e+'" draggable="false">'+l+"</a>"});var u=['<a href="javascript:void(0);" class="select dropdown-toggle ',c," ",d,'" ',p,' id="',s,'_select" aria-haspopup="true" aria-expanded="false" ',t(o.placeHolder),">",o.placeHolder,"</a>",'<div class="dropdown-menu ',o.checkbox?"check-box":""," ",r,'" data-sel-items="">','<li class="dropdown-item title ',!!o.title,'" ',t(o.title),">",o.title,"</li>",'<li class="dropdown-item search ',o.search,'"><input type="text" class="form-control" ',l(o.searchPlaceHolder),' autocomplete="off" /></li>','<li class="dropdown-item list-title ',!!o.listTitle,'" ',t(o.listTitle),">",o.listTitle,"</li>",'<div class="dropdown-menu-scroll" style="max-height:',o.scrollMaxHeight,'px">',n,"</div>",'<li class="dropdown-item search-result hide" ',t(o.searchResultText),">",o.searchResultText,"</li>",'<li class="dropdown-item close-button ',o.closeButton,'"><a href="javascript:;" class="btn btn-primary" ',t(o.buttonText),">",o.buttonText,"</a></li>","</div>"].join("");e.closest("div").addClass("dropdown selectpicker "+a);var h=e.closest(".selectpicker"),f=h.find("#"+s+"_select").length<1;f?$(u).insertAfter(e):h.find(".dropdown-menu-scroll").html(n),window.spa&&spa.i18n.apply(m),o.pills&&e.closest("div").addClass("pills");var m=e.closest(".selectpicker");f&&(m.find(".search input").on("keyup",function(){var e=$(this),s=e.val().toLowerCase();e.closest(".dropdown-menu").find("a.dropdown-item").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(s)>-1)});var t=m.find("a.dropdown-item:visible").length?"addClass":"removeClass";m.find(".search-result")[t]("hide")}),m.on("click",".dropdown-toggle",function(e){e.stopPropagation();var s=$(this),t=s.closest(".selectpicker").find(".dropdown-menu");$(".dropdown.selectpicker").not($(this).closest(".selectpicker")).removeClass("show").find(".dropdown-menu").removeClass("show"),m.toggleClass("show").find(".dropdown-menu").toggleClass("show"),t.find(".search input").val(""),t.find("a.dropdown-item").css("display","block"),t.find("a.dropdown-item.selected").focus(),window.spa&&spa.i18n.apply(".selectpicker .dropdown-menu")}),m.on("click",".dropdown-menu",function(e){$(this).is(".show")&&m.hasClass("multiple")&&e.stopPropagation()}),m.on("click",".close-button a.btn",function(e){m.removeClass("show").find(".dropdown-menu").removeClass("show")}),m.on("click","a.dropdown-item",function(e){var s=$(this),t=s.data("drRel"),l=m.hasClass("multiple"),i=s.closest(".dropdown-menu"),n=i.data("selItems"),a=n?n.split("|"):[];l?s.toggleClass("selected"):(i.find("a.dropdown-item").removeClass("selected"),s.addClass("selected"));var d=s.hasClass("selected");if(m.find('[data-sl-rel="'+t+'"]').prop("selected",d),d)a.push(s.text()),i.data("selItems",a.join("|")).attr("data-sel-items",a.join("|"));else{var c=a.indexOf(s.text());c>-1&&a.splice(c,1),i.data("selItems",a.join("|")).attr("data-sel-items",a.join("|"))}$.fn.selectpick.selections(m,o.placeHolder,o.pills),m.find("select").trigger("change")}),m.on("click","a.pill-close",function(e){e.stopPropagation();var s=$(this),t=s.data("plRel");m.find('[data-dr-rel="'+t+'"]').removeClass("selected"),m.find('[data-sl-rel="'+t+'"]').prop("selected",!1),$.fn.selectpick.selections(m,o.placeHolder,o.pills),m.find("select").trigger("change")})),$.fn.selectpick.selections(m,o.placeHolder,o.pills)})},$.fn.selectpick.selections=function(e,s,t){var l=e,o="",i=l.hasClass("multiple"),n="";l.find("a.dropdown-item.selected").each(function(e,s){var l=$(this),a=l.text(),d=l.data("drRel"),c=l.closest(".dropdown-menu").data("selItems"),r=c.split("|");if(i)if(t)o+='<span class="pill-button">'+a+'<a href="javascript:;" class="pill-close" data-pl-rel="'+d+'">Ã—</a></span>';else{n=r.join(", ");var p=r.length>1?r[0]+'<span title="'+n+'">...(+'+(r.length-1)+")</span>":a;o="<span>"+p+"</span>"}else o="<span>"+a+"</span>"}),l.find(".dropdown-toggle").html(o||"<span>"+s+"</span>"),window.spa&&0==o.length&&s.beginsWithStr("i18n:")&&spa.i18n.apply(".selectpicker")},$(document).click(function(e){$(".selectpicker:not(.multiple)").removeClass("show").find(".dropdown-menu").removeClass("show"),$(".no-close-button").removeClass("show").closest(".selectpicker").removeClass("show")}),$(document).on("focusout",".selectpicker .dropdown-menu.show:not(.has-close-button) .dropdown-item.close-button .btn",function(){setTimeout(()=>{$(this).siblings().is(":focus")||$(this).closest(".selectpicker").removeClass("show").find(".dropdown-menu").removeClass("show")},100)}),document.onkeydown=function(e){e=e||window.event,27==e.keyCode&&$(".selectpicker").removeClass("show").find(".dropdown-menu").removeClass("show"),32==e.keyCode&&$(".selectpicker.show").find(".dropdown-menu a.dropdown-item:focus").trigger("click")},$.fn.selectpick.resetValue=function(e){var s=$(e);s.find("a.select.dropdown-toggle > span").text(""),s.find("div.dropdown-menu-scroll .selected").removeClass("selected")};